<div class="organizar-container">
  <header class="organizar-header">
    <div class="header-left">
      <app-volver></app-volver>
      <h2>Subastas Aceptadas</h2>
      <span class="evento-id">Listado general</span>
    </div>

    <button class="btn-secundario" (click)="Generar()">
      Generar subastas
    </button>
  </header>

  <div class="lista-subastas">
    <div class="fila-subasta" *ngFor="let s of subastas">
      <input type="checkbox" id="img-{{ s.id }}" hidden>
      <label class="img-box" for="img-{{ s.id }}">
        <span class="badge-numero">#{{ s.numeroSubasta || '-' }}</span>
        <img *ngIf="s.imagen; else noImg" [src]="s.imagen">
        <ng-template #noImg>
          <div class="img-empty">Sin imagen</div>
        </ng-template>
      </label>

      <div class="info">
        <h3 class="planta">{{ s.planta }}</h3>
        <div class="precio-row">
          <span class="precio">S/ {{ s.precioBase }}</span>
          <span class="estado estado-aceptado">ACEPTADA</span>
        </div>
        <p class="sub">
          Subastador: <b>{{ s.username }}</b>
        </p>
      </div>

      <div class="acciones">
        <input type="checkbox" id="det-{{ s.id }}" hidden>
        <label for="det-{{ s.id }}" class="btn-detalle primary">Ver detalle</label>

        <button 
          *ngIf="s.numeroSubasta" 
          class="btn-whatsapp" 
          (click)="copiarSubasta(s)">
          <i class="fab fa-whatsapp"></i> Copiar
        </button>

        <div class="drawer">
          <div class="drawer-header">
            <h3>{{ s.planta }}</h3>
            <label for="det-{{ s.id }}">×</label>
          </div>
          <div class="drawer-body">
            <p><b>N° Subasta:</b> {{ s.numeroSubasta || '-' }}</p>
            <p><b>Fecha:</b> {{ s.fechaEvento | date:'dd/MM/yyyy' }}</p>
            <p><b>Hora:</b> {{ s.horaInicioAsignada || '-' }} - {{ s.horaFinAsignada || '-' }}</p>
            <p><b>Duración:</b> {{ s.duracionSubastaMinutos }} min</p>
            <p><b>Descanso:</b> {{ s.descansoMinutos }} min</p>
            <hr>
            <p><b>Contacto:</b> {{ s.username }}</p>
            <p><b>Ciudad:</b> {{ s.city }}</p>
            <p><b>Teléfono:</b> {{ s.phone }}</p>
            <p *ngIf="s.observaciones">
              <b>Observaciones:</b> {{ s.observaciones }}
            </p>
          </div>
        </div>
      </div>

      <div class="zoom">
        <div class="zoom-bg"></div>
        <label for="img-{{ s.id }}" class="zoom-close">×</label>
        <img [src]="s.imagen">
      </div>
    </div>

    <p *ngIf="!subastas.length" class="sin-datos">
      No hay subastas aceptadas.
    </p>
  </div>
</div>